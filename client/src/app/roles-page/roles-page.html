<div class="min-h-screen p-4 md:p-8 bg-white rounded-[3rem] selection:bg-emerald-200">
  <div class="mx-auto max-w-6xl">
    
    <header class="mb-10 flex flex-col md:flex-row md:items-end justify-between gap-4">
      <div>
        <h1 class="text-2xl font-bold text-gray-900 tracking-tight">Roles & Permissions</h1>
        <p class="text-slate-400 mt-1">Configure what different user groups can see and do.</p>
      </div>
      <button (click)="openModal()" class="flex items-center gap-2 bg-black hover:bg-gray-800 text-white px-5 py-2.5 rounded-full transition-all active:scale-95 font-medium text-sm shadow-sm">
        + Create New Role
      </button>
    </header>

    <div class="grid grid-cols-1 gap-8 lg:grid-cols-3">
      
      <aside class="rounded-2xl border shadow-sm overflow-hidden self-start bg-white">
        <div class="border-b p-4">
          <h2 class="text-xs font-black uppercase tracking-widest text-slate-500">User Roles</h2>
        </div>
        <nav class="divide-y divide-gray-100">
          <div *ngFor="let role of roles" 
               (click)="selectRole(role)"
               [ngClass]="{'bg-gray-50': isRoleSelected(role)}"
               class="group flex cursor-pointer items-center justify-between p-5 transition-all hover:bg-gray-50">
            <span class="font-medium" [ngClass]="{'text-black text-2xl': isRoleSelected(role)}">
              {{ role.name }}
            </span>
            <button (click)="deleteRole(role); $event.stopPropagation()" 
                    class="text-slate-400 hover:text-red-500 transition-opacity p-1">
              <svg class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
              </svg>
            </button>
          </div>
        </nav>
      </aside>

      <main class="lg:col-span-2 overflow-hidden rounded-2xl border bg-white">
        <div class="flex items-center justify-between border-b border-gray-100 p-6">
          <div>
            <h2 class="text-2xl font-bold text-gray-900">{{ selectedRole?.name || 'No role selected' }}</h2>
            <p class="text-xs text-slate-500 font-medium uppercase mt-1 tracking-tighter">Current Access Configuration</p>
          </div>
          <button (click)="saveChanges()" class="rounded-full bg-black p-3 text-white hover:bg-gray-800 transition-colors">
            <div class="w-5 h-5">
              <svg fill="currentColor" viewBox="0 0 32 32"><path d="M26 0H6a6 6 0 0 0-6 6v20a6 6 0 0 0 6 6h20a6 6 0 0 0 6-6V6a6 6 0 0 0-6-6zM11 2v3a1 1 0 1 0 2 0V2h10v7H9V2zm19 24a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V6a4 4 0 0 1 4-4h1v8a1 1 0 0 0 1 1h16a1 1 0 0 0 1-1V2h1a4 4 0 0 1 4 4zM16 13a7.5 7.5 0 1 0 7.5 7.5A7.5 7.5 0 0 0 16 13zm0 13a5.5 5.5 0 1 1 5.5-5.5A5.5 5.5 0 0 1 16 26zM16 17.5a3 3 0 1 0 3 3 3 3 0 0 0-3-3zm0 4a1 1 0 1 1 1-1 1 1 0 0 1-1 1z"></path></svg>
            </div>
          </button>
        </div>

        <div class="overflow-x-auto">
          <table class="w-full text-left">
            <thead>
              <tr class="text-[0.7rem] uppercase tracking-widest text-slate-400 border-b border-gray-50">
                <th class="px-8 py-4">Module</th>
                <th class="px-4 py-4 text-center">Read</th>
                <th class="px-4 py-4 text-center">Write</th>
                <th class="px-4 py-4 text-center text-red-400">Delete</th>
              </tr>
            </thead>
            <tbody class="divide-y divide-gray-50">
              <tr *ngFor="let mod of modules" class="hover:bg-gray-50/50 transition-colors">
                <td class="px-8 py-5 font-semibold text-gray-700">{{ mod.name }}</td>
                <td class="px-4 py-5 text-center">
                  <input type="checkbox" [checked]="checkPermission(selectedRole, mod.read)" (change)="togglePermission(selectedRole, mod.read)" class="h-5 w-5 rounded border-gray-300 text-black focus:ring-0">
                </td>
                <td class="px-4 py-5 text-center">
                  <input type="checkbox" [checked]="checkPermission(selectedRole, mod.write)" (change)="togglePermission(selectedRole, mod.write)" class="h-5 w-5 rounded border-gray-300 text-black focus:ring-0">
                </td>
                <td class="px-4 py-5 text-center">
                  <input type="checkbox" [checked]="checkPermission(selectedRole, mod.delete)" (change)="togglePermission(selectedRole, mod.delete)" class="h-5 w-5 rounded border-gray-300 text-black focus:ring-0">
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </main>
    </div>
  </div>

  <div *ngIf="showModal" class="fixed inset-0 z-50 flex items-center justify-center p-4">
    <div (click)="showModal = false" class="absolute inset-0 bg-black/60 backdrop-blur-sm"></div>
    <div class="relative w-full max-w-2xl bg-white rounded-3xl shadow-2xl animate-in zoom-in duration-200 overflow-hidden">
      <div class="p-8 border-b border-gray-100">
        <h2 class="text-2xl font-bold text-gray-900">New Role Identity</h2>
        <p class="text-sm text-slate-400 mt-1">Define the name and initial power levels.</p>
      </div>

      <div class="p-8 max-h-[60vh] overflow-y-auto">
        <div class="mb-8">
          <label class="mb-3 block text-xs font-black uppercase tracking-widest text-slate-500">Role Title</label>
          <input type="text" [(ngModel)]="newRoleName" placeholder="e.g. Content Manager" 
                 class="w-full rounded-xl border border-gray-200 bg-gray-50 p-4 text-gray-900 focus:border-black focus:ring-0 outline-none transition-all text-lg font-medium">
        </div>

        <label class="mb-3 block text-xs font-black uppercase tracking-widest text-slate-500">Initial Permissions</label>
        <div class="rounded-2xl border border-gray-100 overflow-hidden">
          <table class="w-full text-left text-sm">
            <thead class="bg-gray-50">
              <tr class="text-slate-400 text-[10px] font-black uppercase tracking-widest">
                <th class="px-6 py-3">Module</th>
                <th class="px-4 py-3 text-center">Read</th>
                <th class="px-4 py-3 text-center">Write</th>
                <th class="px-4 py-3 text-center">Delete</th>
              </tr>
            </thead>
            <tbody class="divide-y divide-gray-50">
              <tr *ngFor="let mod of modules">
                <td class="px-6 py-4 text-gray-700 font-medium">{{ mod.name }}</td>
                <td class="text-center"><input type="checkbox" (change)="togglePermission({permissions: newRolePermissions}, mod.read)" class="h-4 w-4"></td>
                <td class="text-center"><input type="checkbox" (change)="togglePermission({permissions: newRolePermissions}, mod.write)" class="h-4 w-4"></td>
                <td class="text-center"><input type="checkbox" (change)="togglePermission({permissions: newRolePermissions}, mod.delete)" class="h-4 w-4"></td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <div class="flex items-center justify-end gap-4 p-8 bg-gray-50/50">
        <button (click)="showModal = false" class="px-4 py-2 text-sm font-bold text-slate-400 hover:text-gray-900 transition">Discard</button>
        <button (click)="createRole()" class="rounded-full bg-black px-8 py-3 text-sm font-bold text-white hover:bg-gray-800 transition-all">
          Confirm & Create
        </button>
      </div>
    </div>
  </div>
</div>